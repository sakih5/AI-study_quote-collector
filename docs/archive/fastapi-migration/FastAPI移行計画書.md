# FastAPIç§»è¡Œè¨ˆç”»æ›¸

**ä½œæˆæ—¥**: 2025-11-01
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0
**ç§»è¡Œæ–¹å¼**: ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆï¼ˆæ®µéšçš„ç§»è¡Œï¼‰

---

## ğŸ“‹ ç›®æ¬¡

1. [ç§»è¡Œã®ç›®çš„](#ç§»è¡Œã®ç›®çš„)
2. [ç§»è¡Œæ–¹å¼](#ç§»è¡Œæ–¹å¼)
3. [å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
4. [æ®µéšçš„ç§»è¡Œè¨ˆç”»](#æ®µéšçš„ç§»è¡Œè¨ˆç”»)
5. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯)
6. [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ](#ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ)
7. [ãƒªã‚¹ã‚¯ç®¡ç†](#ãƒªã‚¹ã‚¯ç®¡ç†)
8. [ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»](#ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»)

---

## ğŸ¯ ç§»è¡Œã®ç›®çš„

### ä¸»ãªç›®çš„

1. **å­¦ç¿’**: FastAPI ã¨Pythonã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚’å­¦ã¶
2. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**: FastAPIã®é«˜é€Ÿæ€§ã‚’æ´»ç”¨
3. **æŠ€è¡“æ¯”è¼ƒ**: TypeScriptã¨Pythonã®APIã‚’æ¯”è¼ƒã—ã€ç†è§£ã‚’æ·±ã‚ã‚‹

### å‰¯æ¬¡çš„ãªåŠ¹æœ

- Pythonã®è±Šå¯Œãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚‹
- å°†æ¥çš„ãªAIæ©Ÿèƒ½è¿½åŠ ã®æº–å‚™ï¼ˆæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«çµ±åˆï¼‰
- ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆã®ç†è§£

---

## ğŸ—ï¸ ç§»è¡Œæ–¹å¼

### ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ§‹æˆï¼ˆæ¨å¥¨ï¼‰

æ—¢å­˜ã®Next.js API Routesã‚’æ®‹ã—ãŸã¾ã¾ã€FastAPIã‚’ä¸¦è¡Œç¨¼åƒã•ã›ã‚‹ã€‚

**ãƒ¡ãƒªãƒƒãƒˆ**:
- ãƒªã‚¹ã‚¯ãŒä½ã„ï¼ˆæ—¢å­˜ãŒå£Šã‚Œãªã„ï¼‰
- æ®µéšçš„ã«å­¦ç¿’ãƒ»ç§»è¡Œã§ãã‚‹
- ã„ã¤ã§ã‚‚æˆ»ã›ã‚‹
- TypeScriptã¨Pythonã‚’æ¯”è¼ƒã§ãã‚‹

**æ–¹é‡**:
1. æ—¢å­˜ã®Next.js API Routesã¯å‹•ä½œã•ã›ãŸã¾ã¾
2. FastAPIã‚’æ–°è¦è¿½åŠ ï¼ˆãƒãƒ¼ãƒˆ8000ï¼‰
3. 1ã¤ãšã¤ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ç§»è¡Œ
4. å‹•ä½œç¢ºèªå¾Œã€æ¬¡ã¸é€²ã‚€
5. æœ€çµ‚çš„ã«å…¨ç§»è¡Œå®Œäº†å¾Œã€Next.js API Routesã‚’å‰Šé™¤ï¼ˆä»»æ„ï¼‰

---

## ğŸ›ï¸ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### ç§»è¡Œå‰ï¼ˆç¾åœ¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰                       â”‚
â”‚ Next.js 14 (TypeScript)             â”‚
â”‚ localhost:3000                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API                     â”‚
â”‚ Next.js API Routes (TypeScript)     â”‚
â”‚ localhost:3000/api/*                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹                         â”‚
â”‚ Supabase (PostgreSQL 15)            â”‚
â”‚ + Supabase Auth                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç§»è¡Œä¸­ï¼ˆãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰                       â”‚
â”‚ Next.js 14 (TypeScript)             â”‚
â”‚ localhost:3000                      â”‚
â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                    â”‚
      â†“                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Next.js API  â”‚    â”‚ FastAPI          â”‚
â”‚ (TypeScript) â”‚    â”‚ (Python)         â”‚
â”‚ :3000/api/*  â”‚    â”‚ :8000/api/*      â”‚
â”‚              â”‚    â”‚                  â”‚
â”‚ [æ—¢å­˜]       â”‚    â”‚ [æ–°è¦è¿½åŠ ]       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                     â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹                         â”‚
â”‚ Supabase (PostgreSQL 15)            â”‚
â”‚ + Supabase Auth                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç§»è¡Œå®Œäº†å¾Œï¼ˆæœ€çµ‚å½¢ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰                       â”‚
â”‚ Next.js 14 (TypeScript)             â”‚
â”‚ localhost:3000                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ API                     â”‚
â”‚ FastAPI (Python)                    â”‚
â”‚ localhost:8000/api/*                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹                         â”‚
â”‚ Supabase (PostgreSQL 15)            â”‚
â”‚ + Supabase Auth                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“… æ®µéšçš„ç§»è¡Œè¨ˆç”»

### Phase 0: æº–å‚™ï¼ˆå®Œäº†ï¼‰

- [x] FastAPIã¨TypeScriptã®æ¯”è¼ƒãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
- [x] ç§»è¡Œè¨ˆç”»ç­–å®š

### Phase 1: ç’°å¢ƒæ§‹ç¯‰ï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: FastAPIãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

**ã‚¿ã‚¹ã‚¯**:
1. `backend/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
2. Pythonä»®æƒ³ç’°å¢ƒä½œæˆ
3. FastAPI, Uvicorn, Supabase Clientç­‰ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
4. åŸºæœ¬çš„ãªFastAPIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
5. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèªï¼ˆlocalhost:8000ï¼‰
6. CORSè¨­å®šï¼ˆNext.jsã‹ã‚‰ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ï¼‰

**æˆåŠŸåŸºæº–**:
- FastAPIã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã™ã‚‹
- http://localhost:8000/docs ã§Swagger UIãŒè¡¨ç¤ºã•ã‚Œã‚‹
- Next.jsã‹ã‚‰ç–é€šç¢ºèªã§ãã‚‹

**ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**:
- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ä½œæˆ

---

### Phase 2: èªè¨¼åŸºç›¤ï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: Supabase Authã¨ã®é€£æº

**ã‚¿ã‚¹ã‚¯**:
1. Supabase Python Clientã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
2. JWTãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢å®Ÿè£…
3. èªè¨¼ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆ`@require_auth`ï¼‰ä½œæˆ
4. ãƒ†ã‚¹ãƒˆã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½œæˆ
5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰èªè¨¼ä»˜ããƒªã‚¯ã‚¨ã‚¹ãƒˆç¢ºèª

**æˆåŠŸåŸºæº–**:
- ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‹ã‚‰ã®JWTãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¤œè¨¼ã§ãã‚‹
- æœªèªè¨¼æ™‚ã«401ã‚¨ãƒ©ãƒ¼ã‚’è¿”ã™
- èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ã§ãã‚‹

**å®Ÿè£…ä¾‹**:
```python
# backend/auth.py
from fastapi import Depends, HTTPException
from supabase import create_client

def get_current_user(token: str = Depends(oauth2_scheme)):
    supabase = create_client(...)
    user = supabase.auth.get_user(token)
    if not user:
        raise HTTPException(status_code=401)
    return user
```

---

### Phase 3: æœ€åˆã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆç§»è¡Œï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: `/api/activities` ã‚’FastAPIã§å®Ÿè£…

**ç†ç”±**: æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ä¾å­˜é–¢ä¿‚ãŒå°‘ãªã„

**ã‚¿ã‚¹ã‚¯**:
1. FastAPIã§ `GET /api/activities` å®Ÿè£…
2. Supabaseã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
3. ãƒ¬ã‚¹ãƒãƒ³ã‚¹å‹å®šç¾©ï¼ˆPydanticï¼‰
4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å‘¼ã³å‡ºã—å…ˆã‚’åˆ‡ã‚Šæ›¿ãˆï¼ˆç’°å¢ƒå¤‰æ•°ã§åˆ¶å¾¡ï¼‰
6. å‹•ä½œç¢ºèªãƒ»æ¯”è¼ƒ

**å®Ÿè£…ä¾‹**:
```python
# backend/routes/activities.py
from fastapi import APIRouter, Depends
from pydantic import BaseModel

router = APIRouter()

class Activity(BaseModel):
    id: int
    name: str
    description: str | None
    icon: str
    display_order: int

@router.get("/api/activities", response_model=list[Activity])
async def get_activities(user = Depends(get_current_user)):
    supabase = create_client(...)
    response = supabase.table('activities').select('*').order('display_order').execute()
    return response.data
```

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¿®æ­£**:
```typescript
// .env.local
NEXT_PUBLIC_API_BASE_URL=http://localhost:8000

// hooks/useActivities.ts
const API_BASE = process.env.NEXT_PUBLIC_API_BASE_URL || '';
const response = await fetch(`${API_BASE}/api/activities`);
```

**æˆåŠŸåŸºæº–**:
- FastAPIç‰ˆãŒæ­£å¸¸ã«å‹•ä½œ
- Next.jsç‰ˆã¨åŒã˜ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè¿”ã‚‹
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’æ¯”è¼ƒ

---

### Phase 4: ã‚¿ã‚°APIç§»è¡Œï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: `/api/tags` é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’FastAPIã§å®Ÿè£…

**ã‚¿ã‚¹ã‚¯**:
1. `GET /api/tags`
2. `POST /api/tags`
3. `PUT /api/tags/{id}`
4. `DELETE /api/tags/{id}`
5. `POST /api/tags/{id}/merge`
6. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
7. å‹•ä½œç¢ºèª

**å®Ÿè£…ä¾‹**:
```python
# backend/routes/tags.py
from fastapi import APIRouter, Depends, HTTPException
from pydantic import BaseModel

router = APIRouter()

class TagCreate(BaseModel):
    name: str

class Tag(BaseModel):
    id: int
    user_id: str
    name: str
    created_at: str

@router.get("/api/tags", response_model=list[Tag])
async def get_tags(user = Depends(get_current_user)):
    # å®Ÿè£…
    pass

@router.post("/api/tags", response_model=Tag)
async def create_tag(tag: TagCreate, user = Depends(get_current_user)):
    # å®Ÿè£…
    pass
```

---

### Phase 5: æ›¸ç±APIç§»è¡Œï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: `/api/books` é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’FastAPIã§å®Ÿè£…

**ã‚¿ã‚¹ã‚¯**:
1. `GET /api/books`
2. `POST /api/books`
3. Amazonæ›¸ç±æƒ…å ±å–å¾—æ©Ÿèƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
5. å‹•ä½œç¢ºèª

**å®Ÿè£…ä¾‹**:
```python
# backend/routes/books.py
from fastapi import APIRouter, Depends
from pydantic import BaseModel

router = APIRouter()

class BookCreate(BaseModel):
    title: str
    author: str
    cover_image_url: str | None = None
    isbn: str | None = None
    asin: str | None = None

class Book(BaseModel):
    id: int
    user_id: str
    title: str
    author: str
    # ...

@router.get("/api/books", response_model=list[Book])
async def get_books(user = Depends(get_current_user)):
    # å®Ÿè£…
    pass
```

---

### Phase 6: SNSãƒ¦ãƒ¼ã‚¶ãƒ¼APIç§»è¡Œï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: `/api/sns-users` é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’FastAPIã§å®Ÿè£…

**ã‚¿ã‚¹ã‚¯**:
1. `GET /api/sns-users`
2. `POST /api/sns-users`
3. SNSãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—æ©Ÿèƒ½ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
5. å‹•ä½œç¢ºèª

---

### Phase 7: ãƒ•ãƒ¬ãƒ¼ã‚ºAPIç§»è¡Œï¼ˆ4-5æ™‚é–“ï¼‰

**ç›®æ¨™**: `/api/quotes` é–¢é€£ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’FastAPIã§å®Ÿè£…

**æœ€ã‚‚è¤‡é›‘ãªAPI**

**ã‚¿ã‚¹ã‚¯**:
1. `GET /api/quotes/grouped`ï¼ˆã‚°ãƒ«ãƒ¼ãƒ—åŒ–ä¸€è¦§ï¼‰
2. `POST /api/quotes`ï¼ˆä¸€æ‹¬ç™»éŒ²ï¼‰
3. `PUT /api/quotes/{id}`ï¼ˆæ›´æ–°ï¼‰
4. `DELETE /api/quotes/{id}`ï¼ˆå‰Šé™¤ï¼‰
5. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
6. å‹•ä½œç¢ºèªãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ

**å®Ÿè£…ä¾‹**:
```python
# backend/routes/quotes.py
from fastapi import APIRouter, Depends
from pydantic import BaseModel

router = APIRouter()

class QuoteCreate(BaseModel):
    text: str
    source_type: str
    activity_ids: list[int]
    tag_ids: list[int]
    # ...

@router.post("/api/quotes", response_model=dict)
async def create_quotes(
    quotes: list[QuoteCreate],
    user = Depends(get_current_user)
):
    # å®Ÿè£…
    pass
```

---

### Phase 8: CSVã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆAPIç§»è¡Œï¼ˆ1-2æ™‚é–“ï¼‰

**ç›®æ¨™**: `/api/export/csv` ã‚’FastAPIã§å®Ÿè£…

**ã‚¿ã‚¹ã‚¯**:
1. CSVç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…ï¼ˆPythonã®`csv`ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
2. BOMä»˜ãUTF-8å¯¾å¿œ
3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
4. å‹•ä½œç¢ºèª

**å®Ÿè£…ä¾‹**:
```python
# backend/routes/export.py
from fastapi import APIRouter
from fastapi.responses import StreamingResponse
import csv
import io

router = APIRouter()

@router.get("/api/export/csv")
async def export_csv(user = Depends(get_current_user)):
    # CSVç”Ÿæˆ
    output = io.StringIO()
    writer = csv.writer(output)
    writer.writerow(['ãƒ•ãƒ¬ãƒ¼ã‚º', 'å‡ºå…¸', 'æ´»å‹•é ˜åŸŸ', 'ã‚¿ã‚°', 'ç™»éŒ²æ—¥æ™‚'])
    # ãƒ‡ãƒ¼ã‚¿æ›¸ãè¾¼ã¿...

    output.seek(0)
    return StreamingResponse(
        iter([output.getvalue().encode('utf-8-sig')]),  # BOMä»˜ã
        media_type="text/csv",
        headers={"Content-Disposition": "attachment; filename=quotes.csv"}
    )
```

---

### Phase 9: ãƒ†ã‚¹ãƒˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ3-4æ™‚é–“ï¼‰

**ç›®æ¨™**: å“è³ªä¿è¨¼ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™

**ã‚¿ã‚¹ã‚¯**:
1. å˜ä½“ãƒ†ã‚¹ãƒˆä½œæˆï¼ˆpytestï¼‰
2. E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ
4. API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
5. æŠ€è¡“ä»•æ§˜æ›¸æ›´æ–°

**ãƒ†ã‚¹ãƒˆä¾‹**:
```python
# backend/tests/test_activities.py
from fastapi.testclient import TestClient
from main import app

client = TestClient(app)

def test_get_activities():
    response = client.get("/api/activities")
    assert response.status_code == 200
    assert isinstance(response.json(), list)
```

---

### Phase 10: æœ€çµ‚èª¿æ•´ã¨ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™ï¼ˆ2-3æ™‚é–“ï¼‰

**ç›®æ¨™**: æœ¬ç•ªç’°å¢ƒã¸ã®æº–å‚™

**ã‚¿ã‚¹ã‚¯**:
1. ç’°å¢ƒå¤‰æ•°è¨­å®š
2. DockeråŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
3. ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆæ¤œè¨ï¼ˆHeroku / Railway / AWS Lambdaï¼‰
4. CORSè¨­å®šã®æœ€çµ‚èª¿æ•´
5. Next.js API Routeså‰Šé™¤ï¼ˆä»»æ„ï¼‰

---

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆFastAPIï¼‰

| æŠ€è¡“ | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | ç”¨é€” |
|-----|-----------|------|
| Python | 3.11+ | ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èª |
| FastAPI | 0.104+ | Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ |
| Uvicorn | 0.24+ | ASGIã‚µãƒ¼ãƒãƒ¼ |
| Pydantic | 2.5+ | ãƒ‡ãƒ¼ã‚¿ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
| supabase-py | 2.0+ | Supabaseã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ |
| python-jose | 3.3+ | JWTå‡¦ç† |
| python-multipart | 0.0.6+ | ãƒ•ã‚©ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å‡¦ç† |

### é–‹ç™ºãƒ„ãƒ¼ãƒ«

| æŠ€è¡“ | ç”¨é€” |
|-----|------|
| pytest | ãƒ†ã‚¹ãƒˆ |
| black | ã‚³ãƒ¼ãƒ‰ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼ |
| flake8 | ãƒªãƒ³ã‚¿ãƒ¼ |
| mypy | å‹ãƒã‚§ãƒƒã‚¯ |

---

## ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

### è¿½åŠ ã™ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª

```
AI-study_quote-collector/
â”œâ”€â”€ backend/                      # æ–°è¦è¿½åŠ 
â”‚   â”œâ”€â”€ main.py                   # FastAPIã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ auth.py                   # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”œâ”€â”€ database.py               # Supabaseæ¥ç¶š
â”‚   â”œâ”€â”€ models.py                 # Pydanticãƒ¢ãƒ‡ãƒ«
â”‚   â”œâ”€â”€ routes/                   # APIãƒ«ãƒ¼ãƒˆ
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ activities.py
â”‚   â”‚   â”œâ”€â”€ tags.py
â”‚   â”‚   â”œâ”€â”€ books.py
â”‚   â”‚   â”œâ”€â”€ sns_users.py
â”‚   â”‚   â”œâ”€â”€ quotes.py
â”‚   â”‚   â””â”€â”€ export.py
â”‚   â”œâ”€â”€ tests/                    # ãƒ†ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ test_activities.py
â”‚   â”‚   â”œâ”€â”€ test_tags.py
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ requirements.txt          # Pythonä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ .env                      # ç’°å¢ƒå¤‰æ•°
â”‚   â””â”€â”€ README.md                 # ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
â”‚
â”œâ”€â”€ app/                          # æ—¢å­˜ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‰
â”œâ”€â”€ lib/                          # æ—¢å­˜
â”œâ”€â”€ docs/                         # æ—¢å­˜
â””â”€â”€ ...
```

---

## âš ï¸ ãƒªã‚¹ã‚¯ç®¡ç†

### ãƒªã‚¹ã‚¯ã¨å¯¾ç­–

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | å¯¾ç­– |
|-------|-------|------|
| FastAPIå­¦ç¿’ã«æ™‚é–“ãŒã‹ã‹ã‚‹ | ä¸­ | æ®µéšçš„ã«é€²ã‚ã‚‹ã€æ—¢å­˜ã‚’æ®‹ã™ |
| èªè¨¼é€£æºãŒè¤‡é›‘ | é«˜ | Supabase Authã‚’ç¶™ç¶šåˆ©ç”¨ |
| ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœŸå¾…ä»¥ä¸‹ | ä½ | æ¸¬å®šã—ã¦æ¯”è¼ƒã€å¿…è¦ã«å¿œã˜ã¦æˆ»ã™ |
| CORSã‚¨ãƒ©ãƒ¼ | ä¸­ | é–‹ç™ºåˆæœŸã«å¯¾å¿œ |
| ãƒ‡ãƒ—ãƒ­ã‚¤ãŒè¤‡é›‘åŒ– | ä¸­ | DockeråŒ–ã‚’æ¤œè¨ |

---

## ğŸ”™ ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»

### ã„ã¤ã§ã‚‚æˆ»ã›ã‚‹è¨­è¨ˆ

**ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å´ã§ç’°å¢ƒå¤‰æ•°ã§åˆ‡ã‚Šæ›¿ãˆ**:

```typescript
// .env.local
NEXT_PUBLIC_USE_FASTAPI=false  # falseã§Next.js API Routesä½¿ç”¨
```

```typescript
// lib/api.ts
const API_BASE = process.env.NEXT_PUBLIC_USE_FASTAPI === 'true'
  ? 'http://localhost:8000'
  : '';

export async function fetchActivities() {
  const response = await fetch(`${API_BASE}/api/activities`);
  return response.json();
}
```

**ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †**:
1. `.env.local` ã§ `NEXT_PUBLIC_USE_FASTAPI=false` ã«è¨­å®š
2. ã‚¢ãƒ—ãƒªã‚’å†èµ·å‹•
3. æ—¢å­˜ã®Next.js API RoutesãŒä½¿ç”¨ã•ã‚Œã‚‹

---

## ğŸ“Š é€²æ—ç®¡ç†

### ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

- [ ] Phase 1: ç’°å¢ƒæ§‹ç¯‰
- [ ] Phase 2: èªè¨¼åŸºç›¤
- [ ] Phase 3: `/api/activities` ç§»è¡Œ
- [ ] Phase 4: `/api/tags` ç§»è¡Œ
- [ ] Phase 5: `/api/books` ç§»è¡Œ
- [ ] Phase 6: `/api/sns-users` ç§»è¡Œ
- [ ] Phase 7: `/api/quotes` ç§»è¡Œ
- [ ] Phase 8: `/api/export/csv` ç§»è¡Œ
- [ ] Phase 9: ãƒ†ã‚¹ãƒˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [ ] Phase 10: ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™

### æƒ³å®šæ™‚é–“

| Phase | æ™‚é–“ |
|-------|------|
| Phase 1 | 2-3æ™‚é–“ |
| Phase 2 | 2-3æ™‚é–“ |
| Phase 3 | 2-3æ™‚é–“ |
| Phase 4 | 2-3æ™‚é–“ |
| Phase 5 | 2-3æ™‚é–“ |
| Phase 6 | 2-3æ™‚é–“ |
| Phase 7 | 4-5æ™‚é–“ |
| Phase 8 | 1-2æ™‚é–“ |
| Phase 9 | 3-4æ™‚é–“ |
| Phase 10 | 2-3æ™‚é–“ |
| **åˆè¨ˆ** | **22-32æ™‚é–“** |

---

## ğŸ“ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **Phase 1ã‚’é–‹å§‹**: ç’°å¢ƒæ§‹ç¯‰
2. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã«å¾“ã£ã¦FastAPIãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
3. 1ã¤ãšã¤ç¢ºå®Ÿã«é€²ã‚ã‚‹
4. å„Phaseã§å‹•ä½œç¢ºèªã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

---

**ä½œæˆæ—¥**: 2025-11-01
**æœ€çµ‚æ›´æ–°**: 2025-11-01

---

## ğŸ“Š é€²æ—çŠ¶æ³ï¼ˆ2025-11-01æ›´æ–°ï¼‰

### å®Œäº†ã—ãŸãƒ•ã‚§ãƒ¼ã‚º

| Phase | ã‚¿ã‚¹ã‚¯ | é€²æ— | çŠ¶æ…‹ | å®Œäº†æ—¥ |
|-------|--------|------|------|--------|
| Phase 1 | ç’°å¢ƒæ§‹ç¯‰ | 100% | âœ… å®Œäº† | 2025-11-01 |
| Phase 2 | èªè¨¼åŸºç›¤ | 95% | ğŸ”¶ ã»ã¼å®Œäº† | 2025-11-01 |
| Phase 3 | /api/activities | 0% | â³ æœªç€æ‰‹ | - |
| Phase 4 | ã‚¿ã‚°API | 0% | â³ æœªç€æ‰‹ | - |
| Phase 5 | æ›¸ç±API | 0% | â³ æœªç€æ‰‹ | - |
| Phase 6 | SNSãƒ¦ãƒ¼ã‚¶ãƒ¼API | 0% | â³ æœªç€æ‰‹ | - |
| Phase 7 | ãƒ•ãƒ¬ãƒ¼ã‚ºAPI | 0% | â³ æœªç€æ‰‹ | - |
| Phase 8 | OCR/Export API | 0% | â³ æœªç€æ‰‹ | - |
| Phase 9 | ãƒ†ã‚¹ãƒˆ | 0% | â³ æœªç€æ‰‹ | - |
| Phase 10 | ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™ | 0% | â³ æœªç€æ‰‹ | - |

### Phase 1è©³ç´°ï¼ˆå®Œäº†ï¼‰

- âœ… uvã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆv0.9.7ï¼‰
- âœ… backendãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
- âœ… pyproject.tomlä½œæˆ
- âœ… ä»®æƒ³ç’°å¢ƒä½œæˆï¼ˆuv venvï¼‰
- âœ… ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆ49ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’49msã§å®Œäº†ï¼‰
- âœ… requirements.lockç”Ÿæˆ
- âœ… .envè¨­å®šï¼ˆSupabaseèªè¨¼æƒ…å ±ï¼‰
- âœ… ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ä½œæˆï¼ˆroutes, models, services, testsï¼‰
- âœ… .gitignoreä½œæˆ
- âœ… config.pyä½œæˆ
- âœ… main.pyä½œæˆï¼ˆFastAPIã‚¢ãƒ—ãƒªï¼‰
- âœ… ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèªï¼ˆhttp://localhost:8000ï¼‰
- âœ… Swagger UIç¢ºèªï¼ˆhttp://localhost:8000/docsï¼‰

### Phase 2è©³ç´°ï¼ˆ95%å®Œäº†ï¼‰

- âœ… auth.pyä½œæˆï¼ˆSupabaseèªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
- âœ… get_supabase_client()å®Ÿè£…
- âœ… get_current_user()å®Ÿè£…
- âœ… /api/meã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ 
- âœ… Next.jsãƒˆãƒ¼ã‚¯ãƒ³å–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä½œæˆï¼ˆ/api/get-tokenï¼‰
- âœ… curlã§ã®èªè¨¼ãƒ†ã‚¹ãƒˆæˆåŠŸ
- âš ï¸ Swagger UIèªè¨¼ã‚¨ãƒ©ãƒ¼ï¼ˆæœªè§£æ±ºï¼‰

**æ®‹èª²é¡Œ**:
- Swagger UIã§ã®èªè¨¼å‹•ä½œç¢ºèª

### å®Ÿç¸¾

- **ä½œæ¥­æ™‚é–“**: ç´„3æ™‚é–“
- **ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 15ãƒ•ã‚¡ã‚¤ãƒ«
- **ä½œæˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•°**: 13ãƒ•ã‚¡ã‚¤ãƒ«

### æ¬¡å›ã®ä½œæ¥­

1. Swagger UIèªè¨¼å•é¡Œã®è§£æ±º
2. Phase 3: /api/activitiesã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
   - models/activity.pyä½œæˆ
   - routes/activities.pyä½œæˆ
   - main.pyã«ãƒ«ãƒ¼ã‚¿ãƒ¼ç™»éŒ²
   - å‹•ä½œç¢ºèª

### ä½œæ¥­ãƒ­ã‚°

è©³ç´°ãªä½œæ¥­å†…å®¹ã¯ä»¥ä¸‹ã‚’å‚ç…§ï¼š
- [2025-11-01 Phase 1-2 ä½œæ¥­ãƒ­ã‚°](./development/work_logs/2025-11-01_fastapi_phase1-2.md)

---

**é€²æ—æ›´æ–°æ—¥**: 2025-11-01
